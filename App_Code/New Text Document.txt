SELECT JobCard.Id, Vehicle.Number, isnull(Vehicle_Model.Name,'') + ',' + isnull(Vehicle_Variant.Name,'') + ',' + Vehicle_Brand.Name AS Name FROM            Vehicle_Brand RIGHT OUTER JOIN Vehicle ON Vehicle_Brand.Id = Vehicle.Vehicle_Brand_Id LEFT OUTER JOIN Vehicle_Variant ON Vehicle.Vehicle_Variant_Id = Vehicle_Variant.Id LEFT OUTER JOIN Vehicle_Model ON Vehicle.Vehicle_Model_Id = Vehicle_Model.Id RIGHT OUTER JOIN Requisition INNER JOIN JobCard ON Requisition.JobCardId = JobCard.Id ON Vehicle.Id =JobCard.Vehicle_Id GROUP BY JobCard.Id, Vehicle_Model.Name, Vehicle_Variant.Name, Vehicle_Brand.Name, Vehicle.Number having JobCard.id in (Select  JobCardId from Requisition_Spare where isnull(Requisition_Spare.IsAllocate,0)=0 And isnull(Requisition_Spare.IsDeleted,0)=0 ) 